machine:
  environment:
    ANDROID_NDK_HOME: ${ANDROID_NDK}
dependencies:
  cache_directories:
    - ~/.m2
    - ~/.gradle
  pre:
    - cd example && yarn 
    - cd android && ./gradlew dependencies
test:
  override:
    # start the emulator
    - emulator -avd circleci-android24 -no-window:
        background: true
        parallel: true
    # wait for it to have booted
    - circle-android wait-for-boot
    # install react native
    - cd example && npm start &
    - cd example/android && ./gradlew installDebug
    # run tests  against the emulator.
    - tests/assure-not-foreground.sh
